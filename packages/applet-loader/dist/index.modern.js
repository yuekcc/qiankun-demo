import{loadMicroApp as t,start as e}from"qiankun";import n from"vue";function p(){return(p=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var p in n)Object.prototype.hasOwnProperty.call(n,p)&&(t[p]=n[p])}return t}).apply(this,arguments)}class a{constructor(){this._started=!1,this._appletList=[]}_addApplet(t){const e=t.name,n=this._appletList.findIndex(t=>t.name===e);-1!==n?(this._appletList.splice(n,1,t),console.warn(`[QianKunHelper] updated app manifest, name is '${e}'`)):this._appletList.push(t)}_findAppByName(t){return this._appletList.find(e=>e.name===t)}getProps(t,e){return t.reduce((t,n)=>(t[n]=e[n],t),{})}addApplet(...t){t.forEach(t=>this._addApplet(t))}findApplet(t){return this._findAppByName(t)}loadApplet(e,n,a){const s=p({},e,{container:n,props:this.getProps(e.propKeys||[],a)});return t(s)}start(t){this._started||(t?e(t):e(),this._started=!0)}}const s=new a,r=function(){let t=0;return()=>t++}(),o=(t,e)=>(a,s={autoRemove:!0,propsData:{}})=>{const o=`applet-container-${a}-${r()}`;return n.extend({data:()=>({manifest:null,appInstance:null,errorMessage:""}),computed:{appName(){return this.manifest&&this.manifest.name||"unname"}},mounted(){console.log("AppletComponent mounted. containerId =",o);const n=this,r=t.findApplet(a);if(r){let a=e(n);s&&s.propsData&&Object.keys(s.propsData).length>0&&(a=p({},a,s.propsData)),this.appInstance=t.loadApplet(r,`#${o}`,a)}else this.errorMessage=`applet not found. lookup with name '${a}'`},beforeDestroy(){var t;(null==(t=s.autoRemove)||t)&&this.appInstance&&"function"==typeof this.appInstance.unmount&&(console.log("AppletComponent unmounted. containerId =",o),this.appInstance.unmount())},render(t){return t("div",""!==this.errorMessage?this.errorMessage:{attrs:{id:o},class:"applet-container"})}})};export{a as AppletLoader,s as appletLoader,o as makeAppletComponentCreator};
//# sourceMappingURL=index.modern.js.map
